---
title: 关于PVE备份
published: 2026-01-17
description: ""
image: ""
tags:
  - PVE
category: 硬核搞机
draft: false
updated: 2026-01-17
---
# 关于PVE备份

关于你的疑问：**PVE 的“备份”功能（VZDump）确实不是备份节点（系统本身）的。**

### 1. 备份任务（VZDump）到底备份了什么？

你在数据中心或节点看到的“Backup”任务，备份的是 **虚拟机 (VM)** 和 **容器 (LXC)** 的完整数据。

* **包含**：虚拟机的磁盘数据、配置文件（网卡设置、CPU、内存等）。
* **不包含**：PVE 宿主机本身的操作系统、你在 Shell 下安装的软件、你手动修改的 `/etc/postfix/main.cf` 等系统级配置。

***

### 2. PVE 的系统配置（宿主机）怎么备份？

PVE 官方目前**没有**提供一个像“导出整个系统配置”那样的单一按钮。如果你的 PVE 引导盘坏了，仅仅靠 VM 备份是不够的。你需要手动备份以下关键路径：

#### A. 最核心的配置目录：`/etc/pve`

这是 PVE 最重要的地方。它是一个特殊的集群文件系统（pmxcfs），包含了所有 VM/LXC 的运行配置、存储定义、集群设置。

* **备份命令：**

```shellscript
tar -czvf pve_configs.tar.gz /etc/pve /etc/network/interfaces /etc/hosts /etc/postfix/main.cf

```

#### B. 必须要手动保存的文件清单：

1. **`/etc/pve/`** (所有 VM/LXC 配置)
2. **`/etc/network/interfaces`** (网络网桥配置)
3. **`/etc/hosts`** (主机名解析)
4. **`/etc/fstab`** (挂载的硬盘信息)
5. **`/etc/postfix/`** (你刚配好的邮件设置)
6. **`/etc/cron.d/`** (自定义的定时任务)

***

### 3. 推荐的备份策略：双管齐下

为了在服务器炸了以后能快速恢复，建议你这样做：

| 备份对象                | 推荐工具                                         | 恢复方式                  |
| ------------------- | -------------------------------------------- | --------------------- |
| **虚拟机/容器 (VM/LXC)** | 自带的 Backup 或 **Proxmox Backup Server (PBS)** | 直接在 UI 界面点击 Restore。  |
| **宿主机系统配置**         | 脚本备份 `/etc` 目录                               | 重装 PVE 后，手动把配置文件复制回去。 |
| **整个系统磁盘**          | **Clonezilla (离线)** 或 **dd (在线)**            | 像镜像装机一样，直接全盘恢复。       |

***

### 4. 进阶建议：使用 PBS

如果你有多台机器或者对数据非常在意，强烈建议部署一个 **Proxmox Backup Server (PBS)**。

* 它支持**增量备份**（每次备份只传改动的部分，极快）。
* 它支持**文件级恢复**（不需要恢复整个虚拟机，可以只从备份里提取一个文件）。
* 它也可以安装在 PVE 宿主机上（虽然不推荐这么做，但对于单机用户很方便）。

**您是否需要我为您提供一个自动备份 PVE 系统配置目录的脚本，并让它定期运行？**
